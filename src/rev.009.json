{
  "$schema": "https://json-schema.org/draft-07/schema",
  "$id": "https://github.com/LeShaunJ/ops-schema/blob/main/src/rev.009.json",
  "title": "ops.yaml",
  "type": "object",
  "description": "Confirguration for `ops`.",
  "markdownDescription": "Confirguration for [`ops`](https://github.com/nickthecook/ops).\n\n```yaml\nrevision: ...\ndependencies: ...\nactions: ...\noptions: ...\n```\n",
  "additionalProperties": false,
  "properties": {
    "revision": {},
    "actions": {
      "default": {
        "myaction": {
          "command": "echo \"hello, world\""
        }
      },
      "patternProperties": {
        "^[\\w-]+$": {
          "required": [
            "command"
          ],
          "properties": {
            "alias": {},
            "command": {
              "oneOf": [
                {
                  "$ref": "#/definitions/CommandString"
                },
                {
                  "$ref": "#/definitions/CommandNoop"
                }
              ]
            },
            "description": {},
            "load_secrets": {}
          }
        }
      }
    },
    "dependencies": {
      "properties": {
        "apk": {},
        "apt": {},
        "brew": {
          "items": {
            "$ref": "#/definitions/PackageBrew"
          }
        },
        "cask": {},
        "custom": {
          "items": {
            "description": "",
            "oneOf": [
              {
                "$ref": "#/definitions/CommandString",
                "description": "An idempotent command or script to run as a dependency when `ops up` is executed.",
                "markdownDescription": "An idempotent command or script to run as a dependency when `ops up` is executed."
              },
              {
                "$ref": "#/definitions/CommandNoop"
              }
            ]
          },
          "examples": [
            [
              "bundle install --quiet"
            ]
          ]
        },
        "dir": {},
        "docker": {},
        "gem": {
          "examples": [
            [
              "ejson"
            ]
          ]
        },
        "terraform": {}
      }
    },
    "options": {
      "properties": {
        "apt": {
          "default": {
            "use_sudo": false
          },
          "properties": {
            "use_sudo": {
              "$ref": "#/definitions/UseSudo/properties/use_sudo"
            }
          }
        },
        "config": {
          "properties": {
            "path": {}
          }
        },
        "environment": {
          "patternProperties": {
            "^\\w+$": {}
          }
        },
        "environment_aliases": {
          "examples": [
            [
              "RAILS_ENV",
              "RACK_ENV"
            ]
          ],
          "items": {
            "description": "The name of an environment variable.",
            "$ref": "#/definitions/NameString"
          }
        },
        "exec": {
          "properties": {
            "load_secrets": {
              "$ref": "#/definitions/LoadSecrets"
            }
          }
        },
        "gem": {
          "default": {
            "user_install": true,
            "use_sudo": false
          },
          "properties": {
            "user_install": {},
            "use_sudo": {
              "$ref": "#/definitions/UseSudo/properties/use_sudo"
            }
          }
        },
        "secrets": {
          "properties": {
            "path": {}
          }
        }
      }
    }
  },
  "definitions": {
    "CommandString": {
      "default": "echo \"hello, world\"",
      "examples": [
        "terraform init",
        "docker-compose up"
      ],
      "$ref": "#/definitions/NonEmptyString",
      "title": "Command String"
    },
    "CommandNoop": {
      "title": "No-Op Command",
      "description": "If `true`, executes the command as a `no-op` that exits `0`. If `false`, the `no-op` will always fail.",
      "markdownDescription": "If `true`, executes the command as a `no-op` that exits `0`. If `false`, the `no-op` will always fail.",
      "type": "boolean",
      "default": true
    },
    "Deprecated": {
      "title": "Deprecated",
      "not": {
        "anyOf": [
          {
            "type": "array"
          },
          {
            "type": "boolean"
          },
          {
            "type": "integer"
          },
          {
            "type": "null"
          },
          {
            "type": "number"
          },
          {
            "type": "object"
          },
          {
            "type": "string"
          }
        ]
      }
    },
    "EnvList": {
      "title": "Environment List",
      "type": "array",
      "items": {
        "title": "Environment",
        "description": "A list of environment names.",
        "$ref": "#/definitions/NameString"
      },
      "minItems": 1,
      "uniqueItems": true
    },
    "FileName": {
      "title": "File Name",
      "type": "string",
      "pattern": "^(?!.{256,})(?!(aux|clock\\$|con|nul|prn|com[1-9]|lpt[1-9])(?:$|\\.))[^ ][ \\.\\w-$()+=[\\];#@~,&']+[^\\. ]$",
      "minLength": 1
    },
    "LoadSecrets": {
      "description": "If `true`, items in `secrets.ejson` will be loaded before execution, allowing said items to be referenced in the configuration.",
      "type": "boolean",
      "default": false
    },
    "NameString": {
      "title": "Name String",
      "type": "string",
      "pattern": "^[\\w-]+$"
    },
    "NonEmptyString": {
      "title": "Non-Empty String",
      "type": "string",
      "minLength": 1
    },
    "PackageList": {
      "title": "Package List",
      "type": "array",
      "items": {
        "$ref": "#/definitions/PackageVersioned"
      },
      "minItems": 1,
      "uniqueItems": true
    },
    "PackageBrew": {
      "title": "Brew Package",
      "description": "The name of a `brew` package. If you need to specify a version, include it after the name, delimited by an `@` symbol.",
      "markdownDescription": "The name of a `brew` package. If you need to specify a version, include it after the name, delimited by an `@` symbol.",
      "type": "string",
      "pattern": "^\\b[\\w:.+-]+\\b(@\\b[\\d.]+\\b[\\w.+-]*\\b)?$",
      "examples": [
        "ruby",
        "openssl@"
      ]
    },
    "PackagePip": {
      "title": "Pip Package",
      "description": "The name of a `pip` package. If you need to specify a version, include it after the name, delimited by `==`.",
      "markdownDescription": "The name of a `pip` package. If you need to specify a version, include it after the name, delimited by `==`.",
      "type": "string",
      "pattern": "^\\b[\\w:.+-]+\\b(==\\b[\\d.]+\\b[\\w.+-]*\\b)?$",
      "examples": [
        "semver",
        "ruamel.yaml==0.17.26"
      ]
    },
    "PackageVersioned": {
      "title": "Package",
      "description": "The name of a package. If you need to specify a version, include it after the name, delimited by a space.",
      "markdownDescription": "The name of a package. If you need to specify a version, include it after the name, delimited by a space.",
      "type": "string",
      "pattern": "^\\b[\\w@:.+-]+\\b( \\b[\\d.]+\\b[\\w.+-]*\\b)?$",
      "examples": [
        "ruby",
        "openssl 0.8.0"
      ]
    },
    "Path": {
      "title": "Path",
      "type": "string",
      "format": "uri-reference"
    },
    "PathList": {
      "title": "Path List",
      "type": "array",
      "items": {},
      "minItems": 1,
      "uniqueItems": true
    },
    "SemVer": {
      "title": "Semantic Version",
      "type": "string",
      "pattern": "^(0|[1-9]\\d*)(?:\\.(0|[1-9]\\d*)(?:\\.(0|[1-9]\\d*)(?:[.-]([\\dA-z-]+(?:\\.[\\dA-z-]+)*)|)(\\+[\\dA-z-]+|)|)|)$"
    },
    "UseSudo": {
      "properties": {
        "use_sudo": {
          "title": "UseSudo",
          "description": "If `false`, causes `ops up` to install the dependency's packages without `sudo`.",
          "type": "boolean",
          "default": true
        }
      }
    }
  }
}